---
title: 2018-9-21 Java 面试题
tags: Java,面试
grammar_cjkRuby: true
---
# Java 面试题
## 1. 什么是阻塞式 IO
* 当客户端向服务端发起连接请求时，会被服务端的 Acceptor 接收，然后创建 socket，实现客户端与服务端的连接。
* 客户端与服务端通信时，分为如下步骤：
	1. 客户端写入数据
	2. 服务端读取数据
	3. 服务端写入数据
	4. 客户端读取数据
	以上四个步骤任意一个因为网络延迟、业务处理过程、IO 操作等一些操作耗时较长时，后面所有的操作都必须等待该操作完成，才能串行执行，这就是阻塞式的。

## 2. 装箱与拆箱
Java 是一个面向对象的语言，基本数据类型不具备面向对象特性
### 装箱
把基本数据类型装换成对应的包装类型
### 自动装箱
`Integer i = 1`，即自动装箱，在编译时期会调用 `Integer.valueOf(1)` 方法来装箱
### 拆箱
把包装类型转换为基本数据类型，`int j = Integer.intValue(1)`
### 自动拆箱
`int j = i`， 即自动拆箱，在编译时期会调用 `Integer.intValue(i)` 方法来装箱
### 缓存值 IntegerCache
若 i 大小在 -128 ~ 127 之间时，Integer 类会缓存值，在此范围内的对象 `==` 时是一样的
```
	public static Integer valueOf(int i) {
	if (i >= IntegerCache.low && i <= IntegerCache.high)
		return IntegerCache.cache[i + (-IntegerCache.low)];
	return new Integer(i);
}
```
```
	Integer i = 127;
	Integer j = 127;
	System.out.println(i == j);

	Integer a = 128;
	Integer b = 128;
	System.out.println(a == b);

	// 输出
	true
	false
```
## 3. == 与 equals 区别
### ==
`==` 用来判断两个变量之间的值是否相等。
* 变量可以分为基本类型和引用类型。
* 如果是基本数据类型的变量，直接比较值
* 引用类型比较引用的内存的首地址
## String, StringBuilder, StringBuffer
### String
String 是内容不可变的字符串，底层使用了一个不可变的字符数组，被 final 修饰。
```
/** The value is used for character storage. */
private final char value[];
```
### StringBuilder
继承自 `AbstractStringBuilder` 类，`AbstractStringBuilder` 类保存字符串的形式为可变的字符数组
```
abstract class AbstractStringBuilder implements Appendable, CharSequence {
    /**
     * The value is used for character storage.
     */
    char[] value;
	... 
	}
```
### StringBuffer
继承自 `AbstractStringBuilder` 类，保存字符串的形式与 `StringBuilder` 类似。
* `StringBuffer` 会缓存上次调用 `toString` 方法时所产生的字符串
	```
	/**
     * A cache of the last value returned by toString. Cleared
     * whenever the StringBuffer is modified.
     */
    private transient char[] toStringCache;
	```
* 通过给方法添加 `synchronized` 关键字保证线程安全，`insert` 方法没有添加 `synchronized` 关键字。
## 4. 拷贝一个文件用字节流还是字符流
字符流传送时会转化为字节流
拷贝的文件不确定是只包含字符流 ，有可能有字节流，考虑通用性，要使用字节流
## 5. 线程的实现方式
### 实现
1. 通过继承 Thread 类
2. 通过实现 Runnable 接口
3. 通过实现 Callable 接口

### 启动

## 6. 线程池
### 作用
1. 限定线程的个数，防止线程过多导致系统运行缓慢或崩溃
2. 线程池在开始不需要

## 7. 设计模式
* 单例
* 工厂：Spring IOC 
* 代理模式：Spring AOP 使用动态代理模式
* 包装模式

## 8. GET 与 POST 区别
都是 http 的请求方式，用户通过不同的 http 请求方式完成对资源的操作。GET 一般用于获取与查询资源信息，POST 一般用于更新资源信息
1. GET 请求的数据会在地址栏显示出来，POST 不会
2. GET 请求的长度依赖地址长度限制，GET 传输数据一般较短，POST 可以传输较长的数据
3. POST 比 GET 安全

## 接口和抽象类
## Redis
### 发布订阅
* 命令行方式
1. 多个订阅者订阅 Channel ： `SUBSCRIBE mychannel`
2. 发布者在指定 Channel 发布消息： `PUBLISH mychannel "123"`

* Jedis 方式

```
public class RedisSub extends JedisPubSub{
    @Override
    public void onMessage(String channel, String message) {
        System.out.println("channel: " + channel + " 发布消息： " + message);
    }

    public static void main(String[] args) {
        // 1. 设置 IP, 端口与与密码
        Jedis jedis = new Jedis("120.79.158.194", 6379);
        jedis.auth("Zc-12332145");
        // 2. 创建 JedisPubSub 对象
        RedisSub redisSub = new RedisSub();
        //3. 从 redis 消息 channel 中订阅消息
        jedis.subscribe(redisSub, "mychannel");
    }
}
```
* 优点
	* 系统解耦，顶住流量洪峰
	* 优势是数据存储与缓存
	* 流行的消息队列是 ActiveMQ 与 RabbitMQ

### Redis 事务